<!-- User Message -->
<div *ngIf="message().role === 'user'" class="flex justify-end">
  <div class="max-w-[85%] md:max-w-[70%]">
    <div class="bg-[#2A2A2A] text-gray-100 rounded-2xl rounded-tr-sm px-5 py-3 shadow-sm">
      <!-- Text/URL Content -->
      <p *ngIf="message().type !== 'image'" class="whitespace-pre-wrap break-words">{{ message().content }}</p>
      
      <!-- Image Preview -->
      <div *ngIf="message().type === 'image'" class="space-y-2">
        <img [src]="message().imagePreview" class="max-h-64 rounded-lg border border-gray-600" alt="Uploaded image">
        <p class="text-xs text-gray-400">{{ message().content }}</p>
      </div>
    </div>
  </div>
</div>

<!-- Vera Message -->
<div *ngIf="message().role === 'vera'" class="flex justify-start">
  <div class="max-w-[90%] md:max-w-[75%]">
    <div class="bg-[#D1F2A5] text-gray-900 rounded-2xl rounded-tl-sm px-5 py-4 shadow-sm relative">
      
      <!-- Loading State -->
      <div *ngIf="message().isLoading" class="flex items-center gap-2">
        <div class="w-2 h-2 bg-gray-600 rounded-full animate-bounce"></div>
        <div class="w-2 h-2 bg-gray-600 rounded-full animate-bounce delay-100"></div>
        <div class="w-2 h-2 bg-gray-600 rounded-full animate-bounce delay-200"></div>
      </div>

      <!-- Content -->
      <div *ngIf="!message().isLoading">
        <p class="whitespace-pre-wrap leading-relaxed">{{ message().content }}</p>
        
        <!-- Links Cards -->
        <app-source-links [links]="message().links || []"></app-source-links>
      </div>

    </div>
  </div>
</div>

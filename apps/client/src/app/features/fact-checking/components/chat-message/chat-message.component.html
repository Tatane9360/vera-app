<!-- User Message -->
<div *ngIf="message().role === 'user'" class="flex justify-end">
  <div class="max-w-[85%] md:max-w-[70%]">
    <div class="bg-primary text-vera-cream rounded-2xl rounded-tr-sm px-6 py-4 shadow-md">
      <!-- Text/URL Content -->
      <p *ngIf="message().type !== 'image'" class="whitespace-pre-wrap break-words text-lg font-medium">{{ message().content }}</p>
      
      <!-- Image Preview -->
      <div *ngIf="message().type === 'image'" class="space-y-2">
        <img [src]="message().imagePreview" class="max-h-64 rounded-lg border border-white/10" alt="Uploaded image">
        <p class="text-xs text-vera-cream/70">{{ message().content }}</p>
      </div>
    </div>
  </div>
</div>

<!-- Vera Message -->
<div *ngIf="message().role === 'vera'" class="flex justify-start">
  <div class="max-w-[90%] md:max-w-[75%]">
    <div class="bg-white dark:bg-gray-800 text-primary dark:text-vera-cream rounded-2xl rounded-tl-sm px-6 py-5 shadow-md relative border border-gray-100 dark:border-gray-700">
      
      <!-- Loading State -->
      <div *ngIf="message().isLoading" class="flex items-center gap-2">
        <div class="w-2 h-2 bg-primary dark:bg-vera-cream rounded-full animate-bounce"></div>
        <div class="w-2 h-2 bg-primary dark:bg-vera-cream rounded-full animate-bounce delay-100"></div>
        <div class="w-2 h-2 bg-primary dark:bg-vera-cream rounded-full animate-bounce delay-200"></div>
      </div>

      <!-- Content -->
      <div *ngIf="!message().isLoading">
        <p class="whitespace-pre-wrap leading-relaxed text-lg">{{ message().content }}</p>
        
        <!-- Links Cards -->
        <app-source-links [links]="message().links || []"></app-source-links>
      </div>

    </div>
  </div>
</div>
